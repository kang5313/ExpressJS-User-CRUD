# ExpressJS-User-CRUD
A skeleton for user CRUD operations on web. This skeleton is written by using ExpressJS. JWT is implemented as one of the authentication and verification method.

## Getting Started
1.) Git clone this repo <br>
2.) Run `npm install` to install all the dependencies. <br>
3.) Create new Firebase Project or go to your existing Firebase Project.<br>
4.) Get your Firebase Web API from here `Firebase Project -> Settings -> Project Settings -> General`<br>
5.) Generate your Firebase-Admin SDK service account private key `Firebase Project -> Settings -> Project Settings -> Service Account`. Move the PRIVATE_KEY.json file to node_modules folder<br>
6.) Create a new Google Credential at [Google APIs](https://console.developers.google.com) -> `Credentials` and get the Client ID. <br>
7.) Replace the Google Client ID in `assets/login.html`. <br>
8.) Replace the Firebase Web API and the PRIVATE_KEY.json file path in `index.js` file <br>

## Features
### User Registration
User access to `localhost:3000/register` and fills in the required information in the form and submit. After the user submit the information, a new account will be created in the Firebase Authentication and the user's first name and last name will be stored in the Cloud Firestore. <br><br>
Once the registration is done, a JWT will be sent in the cookie from the expressJS server to client as an access control method to prevent user access to the registration and login page (`localhost:3000\login`) until the user sign out from the system. <br>

### User Login
User can choose either login with their Google account or login with the account created at this project server.<br>Once the user has logged in to the system, a JWT will be sent in the cookie from the expressJS server to client as an access control method to prevent user access to the registration and login page until the user sign out from the system.

### Access Control
A JWT is sent from the the expressJS server to client as an access control method for user to access different web pages.<br><br>
The JWT is generated by the `function GenerateToken(email,res)` and `HS256` is used as the sign algorithm so that synchronous sign key is implemented to sign the JWT.<br><br>

`function accessControlAuthenticated(req,res,url,uid)` is used as the access control for login and registration page. If the cookie is not empty and jwt is successfully verified the page,
the webpage will be redirected to main page. This is to prevent user access the login & register page after they signed in.<br><br>
`function accessControlUnauthenticated(req,res,url,uid)` is used as the access control for the webpages except login and registration page.If the cookie is empty or the jwt in the cookie is false after verified,
then the webpage will be redirected to login page. This is to prevent unauthorized user to access the system.<br>

### Sign Out
A "Logout" button is designed at the top right corner of main page. The logout function will delete the cookie which contain the JWT token and redirect the user back to the login page.
